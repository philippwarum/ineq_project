---
output:
  pdf_document: default
  html_document: default
---



 ---
title: "Einkommensverteilung in Österreich"
subtitle: "2063 - Ökonomie der Verteilung"
author: "Nikolas Kuschnig & Casper Engelen"
abstract: "Dieses Dokument stellt einige Funktionen von Rmarkdown vor und bietet eine simple Grundstruktur für Länder-Reports."
keywords: "a, b, c"
date: '`r format(Sys.time(), "%d %B, %Y")`'
output: 
  pdf_document:
    toc: true
    includes: 
      in_header: header.tex
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

\newpage

# Rmarkdown Demonstration

```{r, include=FALSE}
# load packages
library(dplyr)
library(latticeExtra)
library(RColorBrewer)
library(ggplot2)
```

```{r, eval=FALSE}
cat("Nicht ausgeführt, angezeigt")
```

```{r echo=FALSE}
cat("Ausgeführt, Output angezeigt")
```

```{r}
cat("Ausgeführt, alles angezeigt")
```

<!-- Kommentare im Dokument -->

Text *kursiv* und **fett**.

R-Code im Text: `r pi`

LaTeX Formeln inline: ($e = mc^2$) und:

$$\hat{\beta} = (X'X)^{-1}X'Y$$
 

![Bilder einfügen (xkcd)](img/xkcd_comparison.png){width=60%}

[Links einfügen (Bildquelle)](https://what-if.xkcd.com/118/)

Zitieren aus *BibTeX*:

- [@marmot2010fair; @lancee2012income]
- [@humer2013bedeutung, p. 571]
- @humer2013bedeutung
- @kranzinger2018decomposition
- @beblo2001

Block-Zitate:

> "Don't quote me on that."

Ungeordnete Listen:

- Einkommen
- Kapital

Geordnete Listen:

1. Zahlen
3. sind
9. egal

Simple Tabellen:
<!-- Leerzeichen sind egal -->

|Country  | Gini  | Theil | QSR |
| ---     | ---   | ---   | --- |
| AUT     | 1     | 0.5   | NA  |

R-Plots:

```{r fig-rnorm, echo=FALSE, fig.cap="Inklusive Optionen", fig.width=4}
plot(rnorm(50), rnorm(50))
```

Potentiell weniger simple Tabellen:

Horizontale Linien:

---

\newpage

# Einführung

In dieser Arbeit untersuchen wir die länderübergreifende Einkommensverteilung der EU Staaten auf Basis der EU-SILC Daten über einen Zeitraum von 2004 bis 2017. Während 2004 nur 10 Länder verfügbar sind treten 2007 Bulgarien und Rumänien bei und 2013 vervollständigen sich mit der Aufnahme Kroatiens auf die EU28. 
Im Folgenden werden wir unsere aufbereiteten Daten im Ländervergleich betrachten, da die EU-Mitglieder recht divers sind und jedes Land eigene Charakteristika auf sämtlichen Ebenen hat. Um die Verfügbaren Einkommen gut vergleichen zu können muss man in Betracht ziehen, dass die Lebenshaltungskosten in den Regionen stark variieren. Daher ist es von Notwendigkeit die Kaufkraftparitäten zu berechnen, ein Mittel, um die unterschiedlichen Kosten eines repräsentativen Warenkorbs zu ermitteln. Dabei muss darauf geachtet werden welches Preisniveau als Basis genutzt wird. In unseren Berechnungen ist das durchschnittliche EU-Preisniveau die Basis. Durch die Kaufkraftparitäten werden die Einkommen auch wechselkursbereinigt.


# Empirie

Der Zusammenschluss der Länder zu einem Wirtschaftsraum und einer Währungsgemeinschaft, der Europäischen Union, soll eine Annäherung auf verschiedenen Ebenen herbeiführen. Am Beispiel der Ungleichheit der Einkommen, spiegeln sich verschiedene Einflüsse wieder. 
Ein grundlegender Faktor ist das Wirtschaftswachstum. Fredriksen(2012)  legte hierauf den Fokus seiner Forschung. Er stellte dabei fest, dass die obere Perzentile der Einkommen bei positiver Entwicklung der Volkswirtschaft am meisten profitiert. 

Ein weiterer Gesichtspunkt im Bezug auf die Einkommensverteilung ist die geographische Anordnung. Es ist zu beobachten, dass innerhalb der Länder inwirtschaftlich „stärkere“ und „schwächere“ Regionen untereilt werden kann. Dieser räumliche Faktor sowie die Konvergenz der Einkommen innerhalb der EU wurde von Paas und Schlitte (2006) analysiert. Ihre Forschungsergebnisse zeigen auf, dass die Einkommen vor allem zwischen den ursprünglichen EU-15 und den neueren Mitgliedsstaaten signifikant divergieren. Allerdings ist erkennbar, dass die regionale Ungleichheit bereits auf nationaler Ebene zu Spannungen führen kann. Dies auszugleichen ist oft eine Herausforderung für die Politik auf nationaler Ebene, und noch eine größere auf supranationaler Ebene.
Die Publikation von Beblo und Knaus (2001) wurde in den Anfängen der EU veröffentlicht und gilt für die weitere Forschung oft als Grundlage. Sie konzipieren die Idee eines Eurolandes und berechnen dafür den Theil-Index.Für die EURO10 basierend auf Daten von 1995 ECHP beträgt dieser 0,1849. Ein von Papatheodorou und Pavlopoulos (2014) aktualisierter Theil-Index von 0,148 beinhaltet die EU15 Staaten und wurde mit EU SILC Daten von 2008 berechnet. Kranzinger (2018) hat ebenso EU SILC verwendet und den Theil- Index für die EU-28 für 2014 mit 0,215 berechnet. 
Oben genannte Autoren beschäftigen sich auch mit der Frage der Einkommensverteilungen anhand demographischer Gruppen innerhalb der Länder. Dabei wurden Haushalte nach Alter eingeteilt. Es wird in Gruppen je nach Alter des Oberhauptes eingeteilt. Es wurde die EU sowie die einzelnen Länder analysiert., Dabei stellte sich heraus, dass die Ungleichheit in älteren Haushalten höher ist als die in den Jüngeren. Die Unterschiede zwischen alt und jung lassen sich zum einen auf die Pensionssysteme rückführen, zum anderen auf die davor erwirtschafteten Einkommen, auf die sich die Pensionen beziehen.
 



# Methodologie

untersuchen - einkommensverteilung eu28 - silc - datenbearbeitung - verschiedene maße zur beschreibung der verteilung

## Daten

Zur Untersuchung der länderübergreifenden Einkommensverteilung der EU28 verwenden wir Daten der EU-SILC Erhebung (European Union Statistics on Income and Living Conditions), da diese für den Zeitraum in welchem sie verfügbar sind eine national repräsentative sowie international vergleichbare Datenquelle darstellen, welche nur die Nachteile aufweist die üblicherweise mit Umfrageerhebungen einhergehen. Ebenjene Schwachstellen, wie etwa der "non-response bias", werden nachträglich durch Gewichtung korrigiert, so dass von einer Annäherung der berechneten Verteilungsmaße an ihre realen Größen innerhalb der Bevölkerung auszugehen ist. Für unsere Zwecke ist vor allem die internationale Vergleichbarkeit der EU SILC Daten hervorzuheben. Das Höchstmaß an Vereinheitlichung von Fragestellungen und (Einkommens-)definitionen ermöglicht erst die Konstruktion von Verteilungsmaßen auf länderübergreifender Ebene. 

Für die gegenständliche Analyse stehen EU SILC Daten von 2004 bis 2017 zur Verfügung. Da wir eine Untersuchung der Einkommensverteilung der EU anstreben, können aber nicht alle Daten miteinbezogen werden. So werden erst ab 2008 alle Mitglieder der damaligen EU27 im EU SILC erfasst, während die Daten für die EU28 schon ab 2010 zur Verfügung stehen, obwohl Kroatien erst im Jahr 2013 offiziell Mitglied der EU wurde. Darüber hinaus sind zum aktuellen Zeitpunkt für 2017 nur Daten für 26 Länder verfügbar, während Großbritannien und Irland fehlen. Wir fokussieren die Analyse daher auf den Zeitraum 2008 bis 2016[^1], wobei der Untersuchungsgegenstand für 2008 und 2009 die EU27, aber bereits ab 2010 die EU28 ist. Wir beziehen Kroatien bereits ab 2010 ein, da wir der Auffassung sind, dass das intensive Annäherungsverfahren für angehende EU Mitglieder eine frühere Aufnahme in die Berechnungen der Einkommensverteilung durchaus rechtfertigen können, während ein etwaiger Effekt durch den offiziellen Beitritt zudem erst durch die frühere Aufnahme zu beobachten ist.

[^1]: Sämtliche Berechnungen werden für alle Jahre in denen Daten verfügbar sind durchgeführt, aber nur für diesen Zeitraum untersucht.

EU-SILC Daten werden jährlich, sowohl auf Haushalts- als auch auf Personenebene, erhoben. Da Einkommen aus unterschiedlichen Quellen hervorgehen und sich zudem auf Haushalts- und Personenebene unterscheiden, definieren wir aus Gründen der Vergleichbarkeit und Reproduzierbarkeit für die vorliegende Untersuchung folgende Einkommensvariablen und Grundgesamtheiten, welche hier kurz beschrieben und im Appendix genau erklärt werden. Zunächst zu den Einkommensvariablen. Beim "pre-tax factor income" handelt es sich um die Summe der Primäreinkommen aus Arbeit und Vermögen, während beim "pre-tax national income" Pensionen und Arbeitslosengeld hinzukommen. Das "post-tax disposable income" stellt schließlich das verfügbare Einkommen, nach Erhalt aller sonstigen staatlichen Transferleistungen und abzüglich aller Steuern und Abgaben, dar. Durch die Gegenüberstellung dieser Einkommensvariablen lässt sich also feststellen, wie die staatliche Umverteilung auf die Einkommensverteilung wirkt.

Da Einkommen sowohl auf Haushalts- als auch auf Personenebene entstehen, wird zur Berechnung von Individualeinkommen eine Konvention benötigt, die festlegt wie die unterschiedlichen Haushaltseinkommen den Personen zugeteilt werden. Aus diesem Grund bilden wir zwei Grundgesamtheiten (P1 und P2), bei welchen diese Zuordnung auf unterschiedliche Weise funktioniert. Im Fall von P1 werden sämtliche Einkommen die in einem Haushalt anfallen (inkl. Einkommen auf Personenebene) summiert, durch einen Äquivalenzfaktor dividiert und anschließend allen Personen in einem Haushalt (auch Kindern) zugeteilt. Der Äquivalenzfaktor berücksichtigt dabei den Umstand, dass in Mehrpersonenhaushalten manche Kosten durch Ressourcenteilung pro Person geringer ausfallen (Waschmaschine, Kühlschrank, etc.) und das verfügbare Einkommen somit höher ist. Bei der Grundgesamtheit P1 wird also davon ausgegangen, dass sämtliche Einkommen eines Haushalts zu gleichen Teilen unter den Bewohnern aufgeteilt werden. Demgegenüber bleiben persönliche Einkommen bei der Grundgesamtheit P2 den jeweiligen Personen vorbehalten, während Einkommen auf Haushaltsebene gleichermaßen auf die Bewohner älter als 19 Jahre aufgeteilt werden, während Personen unter 20 aus den Berechnungen ausgeschlossen werden. Im Fall von P2 werden Ressourcen im Haushalt also nur partiell geteilt.

manipulation

## Indikatoren

hier könnten indikatoren und ergebnisse zusammen betrachtet werden

Um ein klares Bild der Einkommensverteilung zu schaffen betrachten wir folgende Indikatoren.

### Median und Mittelwert 
Zu Beginn sind der Median und auch der Mittelwert geeignete Indikatoren, um eine erste Intension über die Größenverhältnisse zu bekommen. Der Median ist davon besonders aufschlussreich, er ist in anderen Worten das 0,5-Quantil und gibt den mittleren Wert der Einkommen an. 
Der Mittelwert hingegen errechnet sich aus der Summe der Werte dividiert durch die Gesamtheit. Daher kann der Mittelwert durch wenige sehr hohe Einkommen einen hohen Wert annehmen, da niedrige Einkommen weniger ins Gewicht fallen. 

### Gini und Theil Index
Da unser Fokus auf der Einkommensungleichheit liegt, ist es wichtig ein geeignetes Maß dafür zu nutzen. 
Folgende Eigenschaften sind dabei zu beachten. Zum einen die Symmetrie was so viel bedeutet wie: Wenn Individuen ihr Einkommen untereinander tauschen hat das keinen Effekt auf die Ungleichheit.  Des Weiteren soll die Unabhängigkeit der Populationsgröße und des Mittelwerts gegeben sein, wenn sich die Population verändert oder alle Einkommen sich verdoppeln bleibt die Ungleichheit unverändert. 
Sowie das sogenannte Pigou-Dalton-Prinzip, welches besagt, dass ein Transfer der Einkommen von reich zu arm Ungleichheit reduziert. 
All eben genannten Bedingungen erfüllt der Gini Index, welcher die Ungleichheit auf einem Intervall von 0 bis 1 beschreibt. Bei einem Gini- Index von 0 verdient jedes Individuum in der Population das gleiche, bei einem Gini-Index von 1 verdient eine Person das gesamte Einkommen.
Der Theil Index basiert auf einer anderen Berechnung, welche den Vorteil hat, dass zu den vier eben genannten Bedingungen zerlegbar ist und man beispielsweise Untergruppen bilden kann, das ist mit dem Gini nicht möglich. 
Das Minimum des Theil Indices ist 0 wie auch beim Gini und ln(N) das Maximum. 
Der T(1) berechnet sich wie folgt $$T(1) = \frac{1}{N} \sum_{i=1}^{N}(\frac{y_i}{\mu})ln(\frac{y_i}{\mu})$$ 


|Variable  |Beschreibung | 
| ---     | ---   | 
| N    | Population   | 
| $y_i$    | individuelles Einkommen   | 
| $\mu$   | Mittelwert des Einkommens der Population   | 

Wir machen uns die Eigenschaft der Zerlegbarkeit folgendermaßen zu Nutze

$$T(1) = \sum_{k=1}^K s_k \times T(1)_k + \sum_{k=1}^K s_k ln(\frac{\mu_k}{\mu}) $$wobei$$ s_k = \frac{\sum_{j=1}^{N_k}y_j}{\sum_{i=1}^{N}y_i} = \frac{N_k * mu_k}{N * mu}$$

|Variable  |Beschreibung | 
| ---     | ---   | 
| K   | Population Untergruppe  | 
| $s_k$    | Anteil des Einkommens der Untergruppe k   |
| $T(1)_k$    | Theil Index der Untergruppe k   | 
| $\mu$   | Mittelwert des Einkommens  |
| $\mu_k$   | Mittelwert des Einkommens der Untergruppe k   |

Der Vorteil des Theil Indexes ist die Eigenschaft der Zerlegbarkeit, somit kann man die ungleichheit innerhalb einer Gruppe untersuchen sowie die Ungleichheilt zwischen den Gruppen. Wir haben unsere Gesamtheit des EU28-Landes in die 28 Mitgliedsländer unterteilt. Damit ist es möglich die Anteile der einzelnen Länder aufzuzeigen, sowie das ökonomische Gewicht innerhalb des EU28-Landes.

### Quantile 
Quantile können beliebig aufgeteilt werden so kann je na Zielsetzung das geeignete Quantil gewählt werden. 
Wir werden die P80/P20 - Rate berechnen, dabei werden die nach der Größe Sortierten Stichproben, in hundert gleich große Gruppen eingeteilt, diese bilden die Perzentile. Für die zu berechnende Rate der oberen 20% Einkommen mit der der Unteren 20% berechnen. Je höher diese Rate ist, desto größer ist die Ungleichheit. 
Zusätzlich analysieren wir den Anteil der obersten 10% der Einkommen.


# Ergebnisse
# Theil Index 
In Tabelle -- vergleichen die Ergebnisse des Theil Indexes der EU-28 untereinander und betrachten dabei vor allem die Unterschiede zwischen 2010 und 2016. Der von uns Für das EU-28-Land berentete Theil beläuft sich im Jahr 2010 auf 0,201 und fällt marginal auf 0,198 im Jahr 2016. Die Unterschiede innerhalb der Länder sind allerdings größer, so fällt der Theil in Österreich von 0,14 auf 0,13. 
Es liegt kein konkretes Muster vor, bei einigen Ländern steigt der Theil Index, beispielsweise in Dänemark, in anderen Ländern wie der Slowakei und Belgien fällt er.
Des Weiteren analysieren wir die Anteile der Ungleichverteilung der Länder, in unserem EU-28-Land, sowie das wirtschaftliche Gewicht der Länder. Welches sich zusätzlich am BIP orientiert, danach ist Deutschland mit 19,25 % bereits 2010 stark repräsentiert, dieses ökonomische Gewicht baut es bis 2016 auf 21,00% aus, der Anteil an der Ungleichheit liegt 2016 allerdings nur bei 16,77%.
Es fällt auf, dass die viel größten EU Länder in Summe einen Anteil von über 50 % besitzen. 


```{r echo=FALSE, warning=FALSE}


library(dplyr)



load("../../data/eu28_indicators.RData")

theil.p1 <- slice(theil.p1,1:28)


theil.p1 <- theil.p1 %>% select(contains("2010"), contains("2016"))

theil.p1 <- theil.p1 %>% select(-contains("fi."), -contains("ni."))


theil_2010.p1 <- theil.p1 %>% select( contains("2010"))
theil_2016.p1 <- theil.p1 %>% select( contains("2016"))


theil.p1 <- theil.p1 %>% select(-contains("fi."), -contains("ni."))


theil_2010.p1 <- theil_2010.p1 %>% mutate_at(vars(contains("theil"):contains("weight"):contains("share")), function(x) as.double(as.character(x)))
theil_2010.p1 <- theil_2010.p1 %>% mutate_at(vars(contains("theil"):contains("weight"):contains("share")), funs(round(., 4)))


theil_2016.p1 <- theil_2016.p1 %>% mutate_at(vars(contains("theil"):contains("weight"):contains("share")), function(x) as.double(as.character(x)))
theil_2016.p1 <- theil_2016.p1 %>% mutate_at(vars(contains("theil"):contains("weight"):contains("share")), funs(round(., 4)))



knitr::kable(theil_2010.p1)
knitr::kable(theil_2016.p1)

```

## Indikatoren

Zu Beginn zeigen wir die bereits beschriebenen Indikatoren zur Erfassung der Ungleichheit über die Jahre 2004 bis 2017. Dabei ist zu beachten, dass erst ab dem Jahr 2008 alle EU –Staaten enthalten sind. In den Jahren davor ist die Ungleichheit recht hoch, was vermutlich mit der Zusammensetzung der Länder zu erklären ist. Die Indikatoren wurden dabei länderübergreifend berechnet. Bei vielen der berechneten Indikatoren fällt auf, dass die Jahre 2005 und 2006 Ausreißer sind, wir vermuten einen Zusammenhang mit der Erweiterung der SILC daten um einige Länder und deren Daten.

In Graph 1 kann man einen stetigen Anstieg bei den Medianeinkommen sowie bei den mittleren Einkommen verzeichnen. In den Jahren 2006, 2009, 2013 fallen Medianeinkommen sowie die Mittleren Einkommen, in den Jahren 2009 und 2013 ist vermutlich die Finanzkriese und die darauffolgende EURO- Krise ein bedeutender Faktor. Der Median wird oft genutzt um einschätzen zu können in welchem Bereich die Mittelschicht der Gesellschaft liegt. Generell sind die Medianeinkommen niedriger als die Mittleren Einkommen. 

Die 80/20 Rate zeigt auf, dass die das 80. Perzentil ungefähr das 6-fache vom 20. Perzentil verdient, dieser Wert bewegt sich im beobachteten Zeitraum in einem Rahmen von 5,311 und 9,33, wenn die die Ausreißer (2005 und 2006) außer acht gelassen werden.  
Bei den Top 10 Prozent ist zu sehen, dass 10% der Bevölkerung ungefähr 25% des Gesamteinkommens verdienen dieser Wert ist über die Jahre leicht gesunken. 
Wir können verzeichnen, dass sich der Gini Index nur marginal verändert hat seit 2009 liegt er bei einem Wert von 0.33. 


```{r echo=FALSE, message=FALSE}



load("../../data/eu28_indicators.RData")



indicators.p1 <- indicators.p1 %>% select(-contains("dii"), -contains("fii"))


data_di <- indicators.p1 %>% select(year, contains("eptdi"))
data_di <- mutate_all(data_di, function(x) as.double(as.character(x)))
data_di <- data_di %>% mutate_at(vars(starts_with("qsr"):starts_with("theil")), funs(round(., 4)))



knitr::kable(data_di)

```

```{r echo=FALSE, message=FALSE}

#plot of mean and median income over time
mean.p1 <- indicators.p1$mean_eptdi
median.p1 <- indicators.p1$median_eptdi

xyplot(mean.p1 + median.p1 ~ year, indicators.p1, type = "b")

```

# Zusammenfassung

potentielle Folgen eines Brexit? UK inequality share!


# Literatur

# Appendix

## Appendix A: Definitionen von Einkommensvariablen und Grundgesamtheiten

### Einkommensvariablen

**1. Pre-tax factor income (Canberra: primary income)**

Summe aus:

(1) Einkommen aus Arbeit (inkl. Selbstständige)

    - gross employee cash or near cash income (PY010G), 
    - company car (PY021G), 
    - gross cash benefits or losses from self-employment (including royalties) (PY050G),
    - income received by people aged under 16 (HY110G);

(2) Vermögenseinkommen

    - income from rental of a property or land (HY040G),
    - interests, dividends, profit from capital investments in unincorporated business (HY090G),
    - pensions received from individual private plans (PY080G),

**2. Pre-tax national income**

(1) $+$ 
(2) $+$

(3) Pensionen + Arbeitslosengeld

    - unemployment benefits (PY090G), 
    - old-age benefits (PY100G),

**3. Post-tax disposable income**

(1) $+$ 
(2) $+$ 
(3) $+$

(4) Alle anderen erhaltenen Transferzahlungen

    - survivor' benefits (PY110G), 
    - sickness benefits (PY120G), 
    - disability benefits (PY130G), 
    - education-related allowances (PY140G);
    - family/children related allowances (HY050G), 
    - social exclusion not elsewhere classified (HY060G), 
    - housing allowances (HY070G), 
    - regular inter-household cash transfers received (HY080G),

(5) abzüglich aller Steuern und Sozialversicherungsabgaben

    - regular taxes on wealth (HY120G), 
    - regular inter-household cash transfer paid (HY130G), 
    - tax on income and social insurance contributions (HY140G).

 

### Grundgesamtheiten

Einige Einkommenskomponenten sind nur auf Haushaltsebene verfügbar. Diese Einkommensvariablen sollen auf zwei unterschiedlichen Varianten auf die Individuen aufgeteilt werden. Innerhalb der beiden Grundgesamtheiten werden keine weiteren Anpassungen des Samples vorgenommen, dh. alle Indikatoren im Bereich P1 und P2 werden jeweils mit der gleichen Anzahl an Beobachtungen berechnet.


**P1 (Eurostat): Gesamte Bevölkerung & equal sharing of resources within household. **

Zunächst wird die Summe der entsprechenden Einkommen pro Haushalt gebildet und anschließend durch den Äquivalenzfaktor (hx050) dividiert. Dieses Äquivalenzeinkommen wird dann allen Personen pro Haushalt (auch jenen unter 16 Jahren, daher SILC – Personenregister, Tabelle R) zugeordnet.


**P2 (wid.world): Nur Personen >= 20 Jahre & partial sharing of resources **

In diesem Fall werden die Einkommensaggregate so gebildet, dass persönliche Einkommen den jeweiligen Personen vorbehalten bleiben und Einkommensarten die nur auf Haushaltsebene verfügbar sind durch die Anzahl der HH Mitglieder >= 20 Jahren dividiert und allen zu gleichen Teilen zugeordnet werden. Personen unter 20 Jahren werden vor der Berechnung der Ungleichheitsindikatoren ausgeschlossen. 


## Appendix B: Auswertungen zu P2


```{r echo=FALSE, message=FALSE}



load("../../data/eu28_indicators.RData")




indicators.p2 <- indicators.p2 %>% select(-contains("dii"), -contains("fii"))



data_di_p2 <- indicators.p2 %>% select(year, contains("ptdi"))
data_di_p2 <- mutate_all(data_di_p2, function(x) as.double(as.character(x)))
data_di_p2 <- data_di_p2 %>% mutate_at(vars(starts_with("qsr"):starts_with("theil")), funs(round(., 4)))

knitr::kable(data_di_p2)
```

```{r echo=FALSE, warning=FALSE}


load("../../data/eu28_indicators.RData")

theil.p2 <- slice(theil.p2,1:28)


theil.p2 <- theil.p2 %>% select(contains("2010"), contains("2016"))

theil.p2 <- theil.p2 %>% select(-contains("fi."), -contains("ni."))


theil_2010.p2 <- theil.p2 %>% select( contains("2010"))
theil_2016.p2 <- theil.p2 %>% select( contains("2016"))

theil.p2 <- theil.p2 %>% select(-contains("fi."), -contains("ni."))

theil_2010.p2 <- theil_2010.p2 %>% mutate_at(vars(contains("theil"):contains("weight"):contains("share")), function(x) as.double(as.character(x)))
theil_2010.p2 <- theil_2010.p2 %>% mutate_at(vars(contains("theil"):contains("weight"):contains("share")), funs(round(., 4)))


theil_2016.p2 <- theil_2016.p2 %>% mutate_at(vars(contains("theil"):contains("weight"):contains("share")), function(x) as.double(as.character(x)))
theil_2016.p2 <- theil_2016.p2 %>% mutate_at(vars(contains("theil"):contains("weight"):contains("share")), funs(round(., 4)))


knitr::kable(theil_2010.p2)
knitr::kable(theil_2016.p2)
```

```{r echo=FALSE, message=FALSE}
theil.vgl <- theil.p1 %>% select(contains("countries"), contains("theil"),-contains("countries.2016"))
ggplot(theil.vgl) +
  geom_segment( aes(x=countries2010, xend=countries2010, y=di.theil2010, yend=di.theil2016), color="grey") +
  geom_point( aes(x=countries2010, y=di.theil2010), color=rgb(0.2,0.7,0.1,0.5), size=3 ) +
  geom_point( aes(x=countries2010, y=di.theil2016), color=rgb(0.7,0.2,0.1,0.5), size=3 ) +
  coord_flip() 
```